FROM debian:buster-slim

RUN echo "root:bigfoot1" | chpasswd

RUN apt-get update && \
    apt-get install -y --no-install-recommends \
    openssh-server \
    python3-serial

# NOTE: apparmor will interfere with dhclient, disable on HOST by running:
# sudo service apparmor stop
# sudo service apparmor teardown

RUN mkdir /var/run/sshd && \
    sed -i 's/.*PermitRootLogin.*/PermitRootLogin yes/' /etc/ssh/sshd_config && \
    sed -i 's/.*GatewayPorts.*/GatewayPorts yes/' /etc/ssh/sshd_config && \
    sed -i 's/.*PermitTunnel.*/PermitTunnel yes/' /etc/ssh/sshd_config

EXPOSE 22
