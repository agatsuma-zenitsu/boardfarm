---
networks:
  default:
    ipam:
      config:
      - gateway: 192.168.55.1
        subnet: 192.168.55.0/24
services:
  bng:
    container_name: bng
    environment:
      CPE_DATA: vl_eth1,10.1.2.1/24,2001:dead:cafe:2::1/64
      CPE_MGMT: vl_eth0,10.1.1.1/24,2001:dead:cafe:1::1/64
      CPE_VOICE: vl_eth2,10.1.3.1/24,2001:dead:cafe:3::1/64
      DHCP_RELAY: 172.25.1.20,2001:dead:beef:2::20
      MCAST_TARGET: vl_eth1
    hostname: bng
    image: 10.64.38.13:5000/bf-router-ethernet:focal-20221130-frr_8.5
    ports:
    - '2002:22'
    privileged: true
  dhcp:
    container_name: dhcp
    environment:
      LEGACY: 'no'
    hostname: dhcp
    image: 10.64.38.13:5000/bf-dhcp:bullseye-3.11.1-kea_dhcp_2.2
    ports:
    - '4020:22'
    - 10120:8080
    privileged: true
    volumes:
    - "$KEA_DHCP4:/etc/kea/kea-dhcp4.conf"
    - "$KEA_DHCP6:/etc/kea/kea-dhcp6.conf"
  ntp:
    container_name: ntp
    environment:
      LEGACY: 'yes'
      NTP_UPSTREAM: 10.64.36.53
    hostname: ntp
    image: 10.64.38.13:5000/bf-ntp:bullseye-3.11.1-ntp_1.4.2
    ports:
    - '4006:22'
    privileged: true
  orchestrator:
    container_name: orchestrator
    depends_on:
    - bng
    - dhcp
    - ntp
    - acs1
    - acs2
    - wan1
    - lan1
    - lan2
    - fxs1
    - fxs2
    hostname: orchestrator
    image: 10.64.38.13:5000/bf-network-orchestrator:alpine3.18-dind-ovs_2.17
    network_mode: host
    pid: host
    privileged: true
    volumes:
    - "/lib/modules:/lib/modules"
    - "/var/run/docker.sock:/var/run/docker.sock"
    - "$NW_CONFIG:/root/config.json"
  acs1:
    container_name: acs1
    environment:
      LEGACY: 'no'
    hostname: acs1
    image: 10.64.38.13:5000/bft:acs2-axiros
    ports:
    - '4501:22'
    - 10501:80
    - 9676:9676
    - 9676:9676/udp
    privileged: true
  acs2:
    container_name: acs2
    environment:
      LEGACY: 'no'
    hostname: acs2
    image: 10.64.38.13:5000/bft:acs2-axiros
    ports:
    - '4502:22'
    - 10502:80
    - 9677:9676
    - 9677:9676/udp
    privileged: true
  wan1:
    container_name: wan1
    environment:
      DNS_UPSTREAM: 10.64.36.53
      LEGACY: 'no'
    hostname: wan1
    image: 10.64.38.13:5000/bf-wan:bullseye-3.11.1-lwds_lite_1.0
    ports:
    - '4002:22'
    - 10101:8080
    privileged: true
  lan1:
    container_name: lan1
    environment:
      LEGACY: 'no'
    hostname: lan1
    image: 10.64.38.13:5000/bf-lan:bullseye-3.11.1-container_utils_1.1.0
    ports:
    - '5001:22'
    - 8001:8080
    privileged: true
  lan2:
    container_name: lan2
    environment:
      LEGACY: 'no'
    hostname: lan2
    image: 10.64.38.13:5000/bf-lan:bullseye-3.11.1-container_utils_1.1.0
    ports:
    - '5002:22'
    - 8002:8080
    privileged: true
  fxs1:
    command: "/usr/sbin/sshd -D"
    container_name: fxs1
    hostname: fxs1
    image: 10.64.38.13:5000/debian_fxs:2022.29.0
    ports:
    - '6001:22'
    privileged: true
  fxs2:
    command: "/usr/sbin/sshd -D"
    container_name: fxs2
    hostname: fxs2
    image: 10.64.38.13:5000/debian_fxs:2022.29.0
    ports:
    - '6002:22'
    privileged: true
version: '3.9'
