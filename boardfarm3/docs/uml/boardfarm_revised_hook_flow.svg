<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="3355px" preserveAspectRatio="none" style="width:1988px;height:3355px;background:#FFFFFF;" version="1.1" viewBox="0 0 1988 3355" width="1988px" zoomAndPan="magnify"><defs/><g><!--MD5=[d39d75d20503768f828654fc47e3a2bb]
cluster CLI--><g id="cluster_CLI"><path d="M881.5,372 L1510.5,372 A12.5,12.5 0 0 1 1523,384.5 L1523,398.2969 L869,398.2969 L869,384.5 A12.5,12.5 0 0 1 881.5,372 " fill="#F1F1F1" style="stroke:#F1F1F1;stroke-width:1.0;"/><rect fill="none" height="310" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="654" x="869" y="372"/><line style="stroke:#181818;stroke-width:0.5;" x1="869" x2="1523" y1="398.2969" y2="398.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="119" x="1136.5" y="389.9951">CLI Parsing Stage</text></g><!--MD5=[d0ac3bb48443da74912b05f24c3586b3]
cluster Reservation--><g id="cluster_Reservation"><path d="M455.5,704 L925.5,704 A12.5,12.5 0 0 1 938,716.5 L938,730.2969 L443,730.2969 L443,716.5 A12.5,12.5 0 0 1 455.5,704 " fill="#F1F1F1" style="stroke:#F1F1F1;stroke-width:1.0;"/><rect fill="none" height="348" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="495" x="443" y="704"/><line style="stroke:#181818;stroke-width:0.5;" x1="443" x2="938" y1="730.2969" y2="730.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="152" x="614.5" y="721.9951">Reserve Device Stage</text></g><!--MD5=[90893be49055836d7fce4a881185a168]
cluster DeployEnv--><g id="cluster_DeployEnv"><path d="M1183.5,1074 L1962.5,1074 A12.5,12.5 0 0 1 1975,1086.5 L1975,1100.2969 L1171,1100.2969 L1171,1086.5 A12.5,12.5 0 0 1 1183.5,1074 " fill="#F1F1F1" style="stroke:#F1F1F1;stroke-width:1.0;"/><rect fill="none" height="614" rx="12.5" ry="12.5" style="stroke:#008000;stroke-width:2.0;" width="804" x="1171" y="1074"/><line style="stroke:#008000;stroke-width:2.0;" x1="1171" x2="1975" y1="1100.2969" y2="1100.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="157" x="1494.5" y="1091.9951">Env Deployment Stage</text></g><!--MD5=[95d8d1c609991844aa1090be3bf0a985]
cluster EnvSetup--><g id="cluster_EnvSetup"><path d="M19.5,1562 L1013.5,1562 A12.5,12.5 0 0 1 1026,1574.5 L1026,1588.2969 L7,1588.2969 L7,1574.5 A12.5,12.5 0 0 1 19.5,1562 " fill="#F1F1F1" style="stroke:#F1F1F1;stroke-width:1.0;"/><rect fill="none" height="1428" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="1019" x="7" y="1562"/><line style="stroke:#181818;stroke-width:0.5;" x1="7" x2="1026" y1="1588.2969" y2="1588.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="114" x="459.5" y="1579.9951">Env Setup Stage</text></g><!--MD5=[2ce57b441d02f115157b8d56bc5b11fa]
cluster ReleaseEnv--><g id="cluster_ReleaseEnv"><path d="M716.5,3067 L1286.5,3067 A12.5,12.5 0 0 1 1299,3079.5 L1299,3093.2969 L704,3093.2969 L704,3079.5 A12.5,12.5 0 0 1 716.5,3067 " fill="#F1F1F1" style="stroke:#F1F1F1;stroke-width:1.0;"/><rect fill="none" height="282" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="595" x="704" y="3067"/><line style="stroke:#181818;stroke-width:0.5;" x1="704" x2="1299" y1="3093.2969" y2="3093.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="129" x="937" y="3084.9951">Release Env Stage</text></g><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="35" x="1171.5" y="350.6982">entry</text><ellipse cx="1189" cy="372" fill="#F1F1F1" rx="6" ry="6" style="stroke:#181818;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="24" x="857" y="509.1982">exit</text><ellipse cx="869" cy="530.5" fill="#F1F1F1" rx="6" ry="6" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1.5;" x1="873.3891" x2="865.6109" y1="534.8891" y2="527.1109"/><line style="stroke:#181818;stroke-width:1.5;" x1="873.3891" x2="865.6109" y1="527.1109" y2="534.8891"/><g id="CLI.ParseCLIArgsHook"><rect fill="#F1F1F1" height="52.5938" rx="12.5" ry="12.5" style="stroke:#008000;stroke-width:2.0;" width="207" x="1299.5" y="604"/><line style="stroke:#008000;stroke-width:2.0;" x1="1299.5" x2="1506.5" y1="630.2969" y2="630.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="126" x="1340" y="621.9951">ParseCLIArgsHook</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="187" x="1304.5" y="648.292">boardfarm_cmdline_parse()</text></g><g id="elem_GMN14"><path d="M891.5,595 L891.5,665.5313 A0,0 0 0 0 891.5,665.5313 L1264.5,665.5313 A0,0 0 0 0 1264.5,665.5313 L1264.5,634.5 L1299.49,630.5 L1264.5,626.5 L1264.5,605 L1254.5,595 L891.5,595 A0,0 0 0 0 891.5,595 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1254.5,595 L1254.5,605 L1264.5,605 L1254.5,595 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="75" x="897.5" y="612.0669">Replace arg</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="92" x="976.5" y="612.0669">bfconfig_file</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="25" x="1072.5" y="612.0669">with</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="98" x="1101.5" y="612.0669">inventory_file</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="50" x="897.5" y="627.1997">Add arg</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="128" x="951.5" y="627.1997">deployment_type</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="897.5" y="642.3325">Â </text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="128" x="897.5" y="657.4653">deployment_type</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="43" x="1029.5" y="657.4653">can be</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="41" x="1076.5" y="657.4653">static</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="1117.5" y="657.4653">/</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="62" x="1121.5" y="657.4653">dynamic</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="1183.5" y="657.4653">/</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="62" x="1187.5" y="657.4653">discover</text></g><g id="CLI.AddCLIArgsHook"><rect fill="#F1F1F1" height="52.5938" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="231" x="1276.5" y="413"/><line style="stroke:#181818;stroke-width:0.5;" x1="1276.5" x2="1507.5" y1="439.2969" y2="439.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="114" x="1335" y="430.9951">AddCLIArgsHook</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="211" x="1281.5" y="457.292">boardfarm_add_cmdline_args()</text></g><g id="elem_reservechoice"><polygon fill="#F1F1F1" points="532,875,544,887,532,899,520,887,532,875" style="stroke:#181818;stroke-width:0.5;"/></g><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="35" x="679.5" y="682.6982">entry</text><ellipse cx="697" cy="704" fill="#F1F1F1" rx="6" ry="6" style="stroke:#181818;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="24" x="926" y="815.1982">exit</text><ellipse cx="938" cy="836.5" fill="#F1F1F1" rx="6" ry="6" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1.5;" x1="942.3891" x2="934.6109" y1="840.8891" y2="833.1109"/><line style="stroke:#181818;stroke-width:1.5;" x1="942.3891" x2="934.6109" y1="833.1109" y2="840.8891"/><g id="Reservation.ReserveDeviceHook"><rect fill="#F1F1F1" height="52.5938" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="219" x="461.5" y="745"/><line style="stroke:#181818;stroke-width:0.5;" x1="461.5" x2="680.5" y1="771.2969" y2="771.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="140" x="501" y="762.9951">ReserveDeviceHook</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="199" x="466.5" y="789.292">boardfarm_reserve_devices()</text></g><g id="Reservation.LockableResource"><rect fill="#F1F1F1" height="52.5938" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="148" x="459" y="983"/><line style="stroke:#181818;stroke-width:0.5;" x1="459" x2="607" y1="1009.2969" y2="1009.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="128" x="469" y="1000.9951">LockableResource</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="104" x="464" y="1027.292">return board ID</text></g><g id="Reservation.CLIArgs"><rect fill="#F1F1F1" height="52.5938" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="195" x="639.5" y="983"/><line style="stroke:#181818;stroke-width:0.5;" x1="639.5" x2="834.5" y1="1009.2969" y2="1009.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="51" x="711.5" y="1000.9951">CLIArgs</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="175" x="644.5" y="1027.292">pick board-name from CLI</text></g><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="35" x="1171.5" y="1052.6982">entry</text><ellipse cx="1189" cy="1074" fill="#F1F1F1" rx="6" ry="6" style="stroke:#181818;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="24" x="1177" y="1215.6982">exit</text><ellipse cx="1189" cy="1237" fill="#F1F1F1" rx="6" ry="6" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1.5;" x1="1193.3891" x2="1185.6109" y1="1241.3891" y2="1233.6109"/><line style="stroke:#181818;stroke-width:1.5;" x1="1193.3891" x2="1185.6109" y1="1233.6109" y2="1241.3891"/><g id="elem_deploy_choice_1"><polygon fill="#F1F1F1" points="1580,1288.5,1592,1300.5,1580,1312.5,1568,1300.5,1580,1288.5" style="stroke:#181818;stroke-width:0.5;"/></g><g id="DeployEnv.DeployEnvHook"><rect fill="#F1F1F1" height="85.1875" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="250" x="1211" y="1115.5"/><line style="stroke:#181818;stroke-width:0.5;" x1="1211" x2="1461" y1="1141.7969" y2="1141.7969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="109" x="1281.5" y="1133.4951">DeployEnvHook</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="165" x="1216" y="1159.792">boardfarm_deploy_env()</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="230" x="1216" y="1176.0889">Parses the INV and ENV to deploy</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="73" x="1216" y="1192.3857">containers</text></g><rect fill="#F1F1F1" height="40" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="109" x="1525.5" y="1138"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="99" x="1530.5" y="1162.8467">ParsePartialInv</text><g id="elem_GMN51"><path d="M1668.5,1115 L1668.5,1154 L1634.84,1158 L1668.5,1162 L1668.5,1200.6641 A0,0 0 0 0 1668.5,1200.6641 L1959.5,1200.6641 A0,0 0 0 0 1959.5,1200.6641 L1959.5,1125 L1949.5,1115 L1668.5,1115 A0,0 0 0 0 1668.5,1115 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1949.5,1115 L1949.5,1125 L1959.5,1125 L1949.5,1115 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="226" x="1674.5" y="1132.0669">Parsing partial INV.json will not be a</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="178" x="1674.5" y="1147.1997">separate hook spec of core.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="261" x="1674.5" y="1162.3325">The plugin for docker factory shall handle</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="270" x="1674.5" y="1177.4653">the parsing internally by implementing the</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="184" x="1674.5" y="1192.5981">boardfarm_deploy_env_hook</text></g><g id="elem_GMN54"><path d="M1626,1273 L1626,1296.5 L1592.01,1300.5 L1626,1304.5 L1626,1328.3984 A0,0 0 0 0 1626,1328.3984 L1944,1328.3984 A0,0 0 0 0 1944,1328.3984 L1944,1283 L1934,1273 L1626,1273 A0,0 0 0 0 1626,1273 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1934,1273 L1934,1283 L1944,1283 L1934,1273 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="253" x="1632" y="1290.0669">if deployment_type is discover it means</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="290" x="1632" y="1305.1997">that we want to regenerate the final INV.JSON</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="297" x="1632" y="1320.3325">based on the partial INV JSON provided earlier.</text></g><g id="DeployEnv.DeployEnvDevices"><rect fill="#F1F1F1" height="68.8906" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="245" x="1340.5" y="1457"/><line style="stroke:#181818;stroke-width:0.5;" x1="1340.5" x2="1585.5" y1="1483.2969" y2="1483.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="128" x="1399" y="1474.9951">DeployEnvDevices</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="225" x="1345.5" y="1501.292">boardfarm_deploy_env_devices()</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="194" x="1345.5" y="1517.5889">Interacts with docker factory</text></g><g id="DeployEnv.GenerateDeployedInv"><rect fill="#F1F1F1" height="68.8906" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="240" x="1445" y="1603"/><line style="stroke:#181818;stroke-width:0.5;" x1="1445" x2="1685" y1="1629.2969" y2="1629.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="150" x="1490" y="1620.9951">GenerateDeployedInv</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="220" x="1450" y="1647.292">boardfarm_generate_inventory()</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="219" x="1450" y="1663.5889">should provide the final INV.json</text></g><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="35" x="881.5" y="1540.6982">entry</text><ellipse cx="899" cy="1562" fill="#F1F1F1" rx="6" ry="6" style="stroke:#181818;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="24" x="1014" y="1686.6982">exit</text><ellipse cx="1026" cy="1708" fill="#F1F1F1" rx="6" ry="6" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1.5;" x1="1030.3891" x2="1022.6109" y1="1712.3891" y2="1704.6109"/><line style="stroke:#181818;stroke-width:1.5;" x1="1030.3891" x2="1022.6109" y1="1704.6109" y2="1712.3891"/><g id="EnvSetup.RegisterHook"><rect fill="#F1F1F1" height="68.8906" rx="12.5" ry="12.5" style="stroke:#008000;stroke-width:2.0;" width="293" x="385.5" y="1603"/><line style="stroke:#008000;stroke-width:2.0;" x1="385.5" x2="678.5" y1="1629.2969" y2="1629.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="94" x="485" y="1620.9951">RegisterHook</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="200" x="390.5" y="1647.292">boardfarm_register_devices()</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="273" x="390.5" y="1663.5889">Should be a Core hook not device hook</text></g><g id="EnvSetup.AddDeviceHook"><rect fill="#F1F1F1" height="68.8906" rx="12.5" ry="12.5" style="stroke:#008000;stroke-width:2.0;" width="291" x="713.5" y="1603"/><line style="stroke:#008000;stroke-width:2.0;" x1="713.5" x2="1004.5" y1="1629.2969" y2="1629.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="110" x="804" y="1620.9951">AddDeviceHook</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="173" x="718.5" y="1647.292">boardfarm_add_devices()</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="271" x="718.5" y="1663.5889">Should be a core hook not device hook</text></g><g id="EnvSetup.ValidateDeviceHook"><rect fill="#F1F1F1" height="68.8906" rx="12.5" ry="12.5" style="stroke:#008000;stroke-width:2.0;" width="234" x="409" y="1744"/><line style="stroke:#008000;stroke-width:2.0;" x1="409" x2="643" y1="1770.2969" y2="1770.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="137" x="457.5" y="1761.9951">ValidateDeviceHook</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="214" x="414" y="1788.292">validate_device_requirements()</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="167" x="414" y="1804.5889">Validate against INV.json</text></g><g id="EnvSetup.SetupEnvHook"><rect fill="#F1F1F1" height="68.8906" rx="12.5" ry="12.5" style="stroke:#008000;stroke-width:2.0;" width="236" x="378" y="1890"/><line style="stroke:#008000;stroke-width:2.0;" x1="378" x2="614" y1="1916.2969" y2="1916.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="102" x="445" y="1907.9951">SetupEnvHook</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="159" x="383" y="1934.292">boardfarm_setup_env()</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="216" x="383" y="1950.5889">Calling all device booting hooks</text></g><g id="elem_GMN75"><path d="M23,1610 L23,1665.3984 A0,0 0 0 0 23,1665.3984 L351,1665.3984 A0,0 0 0 0 351,1665.3984 L351,1641.5 L385.35,1637.5 L351,1633.5 L351,1620 L341,1610 L23,1610 A0,0 0 0 0 23,1610 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M341,1610 L341,1620 L351,1620 L341,1610 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="93" x="29" y="1627.0669">Moved this up.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="270" x="29" y="1642.1997">Since registering devices is a core activity.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="307" x="29" y="1657.3325">And should happen first before intiating booting.</text></g><g id="elem_GMN78"><path d="M35,1904.5 L35,1944.7656 A0,0 0 0 0 35,1944.7656 L343,1944.7656 A0,0 0 0 0 343,1944.7656 L343,1928.5 L377.74,1924.5 L343,1920.5 L343,1914.5 L333,1904.5 L35,1904.5 A0,0 0 0 0 35,1904.5 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M333,1904.5 L333,1914.5 L343,1914.5 L333,1904.5 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="188" x="41" y="1921.5669">Renamed it to SetupEnvHook</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="287" x="41" y="1936.6997">It does not deploy but calls all booting hooks.</text></g><g id="elem_skip_choice"><polygon fill="#F1F1F1" points="401,2050.5,413,2062.5,401,2074.5,389,2062.5,401,2050.5" style="stroke:#181818;stroke-width:0.5;"/></g><g id="EnvSetup.SkipBootHook"><rect fill="#F1F1F1" height="85.1875" rx="12.5" ry="12.5" style="stroke:#008000;stroke-width:2.0;" width="405" x="579.5" y="2020"/><line style="stroke:#008000;stroke-width:2.0;" x1="579.5" x2="984.5" y1="2046.2969" y2="2046.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="98" x="733" y="2037.9951">SkipBootHook</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="154" x="584.5" y="2064.292">boardfarm_skip_boot()</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="179" x="584.5" y="2080.5889">In case there are activities</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="385" x="584.5" y="2096.8857">needed to be performed before handling out the device</text></g><g id="elem_GMN107"><path d="M640,2477.5 L640,2493.5 L605.85,2497.5 L640,2501.5 L640,2517.7656 A0,0 0 0 0 640,2517.7656 L1004,2517.7656 A0,0 0 0 0 1004,2517.7656 L1004,2487.5 L994,2477.5 L640,2477.5 A0,0 0 0 0 640,2477.5 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M994,2477.5 L994,2487.5 L1004,2487.5 L994,2477.5 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="343" x="646" y="2494.5669">The Booting stage must be a simple call to all booting</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="307" x="646" y="2509.6997">hook implementations implemented by devices.</text></g><g id="EnvSetup.PostEnvSetupHook"><rect fill="#F1F1F1" height="68.8906" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="251" x="679.5" y="2905"/><line style="stroke:#181818;stroke-width:0.5;" x1="679.5" x2="930.5" y1="2931.2969" y2="2931.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="133" x="738.5" y="2922.9951">PostEnvSetupHook</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="231" x="684.5" y="2949.292">boardfarm_post_deploy_devices()</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="219" x="684.5" y="2965.5889">Disconnect disposable services</text></g><g id="elem_GMN111"><path d="M391,2927 L391,2952.1328 A0,0 0 0 0 391,2952.1328 L645,2952.1328 A0,0 0 0 0 645,2952.1328 L645,2945 L679.25,2939.5 L645,2937 L645,2937 L635,2927 L391,2927 A0,0 0 0 0 391,2927 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M635,2927 L635,2937 L645,2937 L635,2927 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="233" x="397" y="2944.0669">Renamed now to PostEnvSetupHook</text></g><path d="M99,2182 L592.5,2182 A12.5,12.5 0 0 1 605,2194.5 L605,2208.2969 L86.5,2208.2969 L86.5,2194.5 A12.5,12.5 0 0 1 99,2182 " fill="#F1F1F1" style="stroke:#F1F1F1;stroke-width:1.0;"/><rect fill="none" height="631.1875" rx="12.5" ry="12.5" style="stroke:#008000;stroke-width:2.0;" width="518.5" x="86.5" y="2182"/><line style="stroke:#008000;stroke-width:2.0;" x1="86.5" x2="605" y1="2208.2969" y2="2208.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="97" x="297.25" y="2199.9951">Booting stage</text><g id="EnvSetup.Booting.ServerBootHook"><rect fill="#F1F1F1" height="52.5938" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="301" x="98.5" y="2220.2969"/><line style="stroke:#181818;stroke-width:0.5;" x1="98.5" x2="399.5" y1="2246.5938" y2="2246.5938"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="113" x="192.5" y="2238.292">ServerBootHook</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="281" x="103.5" y="2264.5889">boardfarm_server_boot()\bBBoot servers</text></g><rect fill="#F1F1F1" height="40" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="95" x="492.5" y="2226.7969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="85" x="497.5" y="2251.6436">SetupServer</text><g id="EnvSetup.Booting.ServerConfigureHook"><rect fill="#F1F1F1" height="68.8906" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="222" x="138" y="2310.2969"/><line style="stroke:#181818;stroke-width:0.5;" x1="138" x2="360" y1="2336.5938" y2="2336.5938"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="147" x="175.5" y="2328.292">ServerConfigureHook</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="202" x="143" y="2354.5889">boardfarm_server_configure()</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="122" x="143" y="2370.8857">Configure servers</text></g><g id="EnvSetup.Booting.DeviceBootHook"><rect fill="#F1F1F1" height="68.8906" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="191" x="153.5" y="2416.2969"/><line style="stroke:#181818;stroke-width:0.5;" x1="153.5" x2="344.5" y1="2442.5938" y2="2442.5938"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="116" x="191" y="2434.292">DeviceBootHook</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="171" x="158.5" y="2460.5889">boardfarm_device_boot()</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="65" x="158.5" y="2476.8857">Boot CPE</text></g><rect fill="#F1F1F1" height="40" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="71" x="437.5" y="2430.7969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="61" x="442.5" y="2455.6436">BootCPE</text><g id="EnvSetup.Booting.DeviceConfigureHook"><rect fill="#F1F1F1" height="68.8906" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="224" x="137" y="2522.2969"/><line style="stroke:#181818;stroke-width:0.5;" x1="137" x2="361" y1="2548.5938" y2="2548.5938"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="150" x="174" y="2540.292">DeviceConfigureHook</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="204" x="142" y="2566.5889">boardfarm_device_configure()</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="99" x="142" y="2582.8857">Configure CPE</text></g><g id="EnvSetup.Booting.AddnDeviceBootHook"><rect fill="#F1F1F1" height="68.8906" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="259" x="119.5" y="2628.2969"/><line style="stroke:#181818;stroke-width:0.5;" x1="119.5" x2="378.5" y1="2654.5938" y2="2654.5938"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="152" x="173" y="2646.292">AddnDeviceBootHook</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="239" x="124.5" y="2672.5889">boardfarm_attached_device_boot()</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="79" x="124.5" y="2688.8857">Boot Extras</text></g><rect fill="#F1F1F1" height="40" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="126" x="471" y="2642.7969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="116" x="476" y="2667.6436">BootAddnDevice</text><g id="EnvSetup.Booting.AddnDeviceConfigureHook"><rect fill="#F1F1F1" height="68.8906" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="292" x="103" y="2734.2969"/><line style="stroke:#181818;stroke-width:0.5;" x1="103" x2="395" y1="2760.5938" y2="2760.5938"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="186" x="156" y="2752.292">AddnDeviceConfigureHook</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="272" x="108" y="2778.5889">boardfarm_attached_device_configure()</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="113" x="108" y="2794.8857">Configure Extras</text></g><!--MD5=[8ba783e4ca0c4e6c258b20323f9f8dde]
link ServerBootHook to SetupServer--><g id="link_ServerBootHook_SetupServer"><path d="M399.61,2246.7969 C431.08,2246.7969 462.22,2246.7969 487.15,2246.7969 " fill="none" id="ServerBootHook-to-SetupServer" style="stroke:#008000;stroke-width:1.0;"/><polygon fill="#008000" points="492.37,2246.7969,483.37,2242.7969,487.37,2246.7969,483.37,2250.7969,492.37,2246.7969" style="stroke:#008000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="73" x="409.5" y="2239.8638">internal call</text></g><!--MD5=[7d87d6f495667a063907f3338508d0c9]
link ServerBootHook to ServerConfigureHook--><g id="link_ServerBootHook_ServerConfigureHook"><path d="M249,2273.5269 C249,2283.1669 249,2294.3469 249,2304.9169 " fill="none" id="ServerBootHook-to-ServerConfigureHook" style="stroke:#008000;stroke-width:1.0;"/><polygon fill="#008000" points="249,2310.0469,253,2301.0469,249,2305.0469,245,2301.0469,249,2310.0469" style="stroke:#008000;stroke-width:1.0;"/></g><!--MD5=[37ec2ebb77003c90b18dee21e509df36]
link ServerConfigureHook to DeviceBootHook--><g id="link_ServerConfigureHook_DeviceBootHook"><path d="M249,2379.5669 C249,2389.6569 249,2400.7969 249,2411.1769 " fill="none" id="ServerConfigureHook-to-DeviceBootHook" style="stroke:#008000;stroke-width:1.0;"/><polygon fill="#008000" points="249,2416.1969,253,2407.1969,249,2411.1969,245,2407.1969,249,2416.1969" style="stroke:#008000;stroke-width:1.0;"/></g><!--MD5=[bb4698e29cac114f8a9108bebcaca26e]
link DeviceBootHook to BootCPE--><g id="link_DeviceBootHook_BootCPE"><path d="M344.65,2450.7969 C375.29,2450.7969 407.59,2450.7969 432.13,2450.7969 " fill="none" id="DeviceBootHook-to-BootCPE" style="stroke:#008000;stroke-width:1.0;"/><polygon fill="#008000" points="437.25,2450.7969,428.25,2446.7969,432.25,2450.7969,428.25,2454.7969,437.25,2450.7969" style="stroke:#008000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="73" x="354.5" y="2443.8638">internal call</text></g><!--MD5=[63634851376d78902f35365ca00e639e]
link DeviceBootHook to DeviceConfigureHook--><g id="link_DeviceBootHook_DeviceConfigureHook"><path d="M249,2485.5669 C249,2495.6569 249,2506.7969 249,2517.1769 " fill="none" id="DeviceBootHook-to-DeviceConfigureHook" style="stroke:#008000;stroke-width:1.0;"/><polygon fill="#008000" points="249,2522.1969,253,2513.1969,249,2517.1969,245,2513.1969,249,2522.1969" style="stroke:#008000;stroke-width:1.0;"/></g><!--MD5=[05b63661ff4e1de62b1bec44b5ee2073]
link DeviceConfigureHook to AddnDeviceBootHook--><g id="link_DeviceConfigureHook_AddnDeviceBootHook"><path d="M249,2591.5669 C249,2601.6569 249,2612.7969 249,2623.1769 " fill="none" id="DeviceConfigureHook-to-AddnDeviceBootHook" style="stroke:#008000;stroke-width:1.0;"/><polygon fill="#008000" points="249,2628.1969,253,2619.1969,249,2623.1969,245,2619.1969,249,2628.1969" style="stroke:#008000;stroke-width:1.0;"/></g><!--MD5=[834063ce656211202f5322f042e05402]
link AddnDeviceBootHook to BootAddnDevice--><g id="link_AddnDeviceBootHook_BootAddnDevice"><path d="M378.57,2662.7969 C408.63,2662.7969 439.45,2662.7969 465.64,2662.7969 " fill="none" id="AddnDeviceBootHook-to-BootAddnDevice" style="stroke:#008000;stroke-width:1.0;"/><polygon fill="#008000" points="470.82,2662.7969,461.82,2658.7969,465.82,2662.7969,461.82,2666.7969,470.82,2662.7969" style="stroke:#008000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="73" x="388.25" y="2655.8638">internal call</text></g><!--MD5=[1e91d6ef86b1482fb6c0eb71e655727a]
link AddnDeviceBootHook to AddnDeviceConfigureHook--><g id="link_AddnDeviceBootHook_AddnDeviceConfigureHook"><path d="M249,2697.5669 C249,2707.6569 249,2718.7969 249,2729.1769 " fill="none" id="AddnDeviceBootHook-to-AddnDeviceConfigureHook" style="stroke:#008000;stroke-width:1.0;"/><polygon fill="#008000" points="249,2734.1969,253,2725.1969,249,2729.1969,245,2725.1969,249,2734.1969" style="stroke:#008000;stroke-width:1.0;"/></g><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="35" x="787.5" y="3045.6982">entry</text><ellipse cx="805" cy="3067" fill="#F1F1F1" rx="6" ry="6" style="stroke:#181818;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="24" x="1287" y="3244.4951">exit</text><ellipse cx="1299" cy="3225.5" fill="#F1F1F1" rx="6" ry="6" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1.5;" x1="1303.3891" x2="1295.6109" y1="3229.8891" y2="3222.1109"/><line style="stroke:#181818;stroke-width:1.5;" x1="1303.3891" x2="1295.6109" y1="3222.1109" y2="3229.8891"/><g id="ReleaseEnv.ReleaseDeviceHook"><rect fill="#F1F1F1" height="68.8906" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="218" x="725" y="3118"/><line style="stroke:#181818;stroke-width:0.5;" x1="725" x2="943" y1="3144.2969" y2="3144.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="139" x="764.5" y="3135.9951">ReleaseDeviceHook</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="198" x="730" y="3162.292">boardfarm_release_devices()</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="131" x="730" y="3178.5889">Release all devices</text></g><g id="ReleaseEnv.DeviceShutdownHook"><rect fill="#F1F1F1" height="68.8906" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="228" x="720" y="3264"/><line style="stroke:#181818;stroke-width:0.5;" x1="720" x2="948" y1="3290.2969" y2="3290.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="153" x="757.5" y="3281.9951">DeviceShutdownHook</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="208" x="725" y="3308.292">boardfarm_shutdown_device()</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="160" x="725" y="3324.5889">Shutdown connections</text></g><g id="elem_GMN130"><path d="M983,3278.5 L983,3294.5 L948.18,3298.5 L983,3302.5 L983,3318.7656 A0,0 0 0 0 983,3318.7656 L1277,3318.7656 A0,0 0 0 0 1277,3318.7656 L1277,3288.5 L1267,3278.5 L983,3278.5 A0,0 0 0 0 983,3278.5 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1267,3278.5 L1267,3288.5 L1277,3288.5 L1267,3278.5 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="224" x="989" y="3295.5669">If we have a device shutdown hook.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="273" x="989" y="3310.6997">Shouldn't we have a device powerup hook?</text></g><ellipse cx="1175" cy="16" fill="#222222" rx="10" ry="10" style="stroke:none;stroke-width:1.0;"/><rect fill="#F1F1F1" height="40" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="50" x="1150" y="103"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="32" x="1159" y="127.8467">Main</text><g id="PluginManager"><rect fill="#F1F1F1" height="68.8906" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="173" x="1009.5" y="220"/><line style="stroke:#181818;stroke-width:0.5;" x1="1009.5" x2="1182.5" y1="246.2969" y2="246.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="102" x="1045" y="237.9951">PluginManager</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="114" x="1014.5" y="264.292">init all BF plugins</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="153" x="1014.5" y="280.5889">Reads BF entry-points</text></g><rect fill="#F1F1F1" height="40" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="77" x="1217.5" y="234.5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="67" x="1222.5" y="259.3467">ArgParser</text><ellipse cx="1665" cy="630.5" fill="none" rx="10" ry="10" style="stroke:#222222;stroke-width:1.0;"/><ellipse cx="1665.5" cy="631" fill="#222222" rx="6" ry="6" style="stroke:none;stroke-width:1.0;"/><g id="BoardfarmConfigure"><rect fill="#F1F1F1" height="68.8906" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="262" x="566" y="496"/><line style="stroke:#181818;stroke-width:0.5;" x1="566" x2="828" y1="522.2969" y2="522.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="138" x="628" y="513.9951">BoardfarmConfigure</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="152" x="571" y="540.292">boardfarm_configure()</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="242" x="571" y="556.5889">TBD, adds hook stages to the core</text></g><ellipse cx="423" cy="771.5" fill="none" rx="10" ry="10" style="stroke:#222222;stroke-width:1.0;"/><ellipse cx="423.5" cy="772" fill="#222222" rx="6" ry="6" style="stroke:none;stroke-width:1.0;"/><g id="elem_deploy_choice"><polygon fill="#F1F1F1" points="978,929,990,941,978,953,966,941,978,929" style="stroke:#181818;stroke-width:0.5;"/></g><g id="ParseInventory"><rect fill="#F1F1F1" height="68.8906" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="205" x="875.5" y="1358"/><line style="stroke:#181818;stroke-width:0.5;" x1="875.5" x2="1080.5" y1="1384.2969" y2="1384.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="102" x="927" y="1375.9951">ParseInventory</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="175" x="880.5" y="1402.292">parse_boardfarm_config()</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="185" x="880.5" y="1418.5889">Parses INV.json for devices</text></g><ellipse cx="608" cy="1392.5" fill="none" rx="10" ry="10" style="stroke:#222222;stroke-width:1.0;"/><ellipse cx="608.5" cy="1393" fill="#222222" rx="6" ry="6" style="stroke:none;stroke-width:1.0;"/><g id="elem_choice_output"><polygon fill="#F1F1F1" points="1090,2485.5,1102,2497.5,1090,2509.5,1078,2497.5,1090,2485.5" style="stroke:#181818;stroke-width:0.5;"/></g><ellipse cx="1311" cy="2939.5" fill="none" rx="10" ry="10" style="stroke:#222222;stroke-width:1.0;"/><ellipse cx="1311.5" cy="2940" fill="#222222" rx="6" ry="6" style="stroke:none;stroke-width:1.0;"/><g id="Execution"><rect fill="#F1F1F1" height="52.5938" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="244" x="1048" y="2913"/><line style="stroke:#181818;stroke-width:0.5;" x1="1048" x2="1292" y1="2939.2969" y2="2939.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="68" x="1136" y="2930.9951">Execution</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="224" x="1053" y="2957.292">Can be tests or interact session.</text></g><!--MD5=[743761f828eeadc8c3ff83be990b5658]
link *start to Main--><g id="link_*start_Main"><path d="M1175,26.32 C1175,42.12 1175,74.65 1175,97.38 " fill="none" id="*start-to-Main" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1175,102.64,1179,93.64,1175,97.64,1171,93.64,1175,102.64" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="101" x="1176" y="69.0669">start boardfarm</text></g><!--MD5=[6530e5ae41ffa88603919c6be07b6a02]
link Main to PluginManager--><g id="link_Main_PluginManager"><path d="M1163.34,143.11 C1151.75,162.12 1133.64,191.8 1119.12,215.61 " fill="none" id="Main-to-PluginManager" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1116.45,219.98,1124.5463,214.372,1119.0497,215.709,1117.7127,210.2124,1116.45,219.98" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="19" x="1145" y="186.0669">init</text></g><!--MD5=[1e1cffdbda8f5af32880d7f861867952]
link Main to ArgParser--><g id="link_Main_ArgParser"><path d="M1186.95,143.11 C1201.37,166.16 1225.61,204.91 1241.19,229.83 " fill="none" id="Main-to-ArgParser" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1244,234.31,1242.6368,224.5559,1241.3564,230.066,1235.8464,228.7857,1244,234.31" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="19" x="1216" y="186.0669">init</text></g><!--MD5=[86888201fdefd023b2fcc9480d22d093]
link PluginManager to entry_cli_stage--><g id="link_PluginManager_entry_cli_stage"><path d="M1123.15,289.22 C1143.56,314.56 1170.01,347.42 1182.25,362.62 " fill="none" id="PluginManager-to-entry_cli_stage" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1185.57,366.74,1183.0202,357.2269,1182.4257,362.8524,1176.8001,362.2579,1185.57,366.74" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[d130919fb3ec04d3341dfd3b4ff4272f]
link ArgParser to entry_cli_stage--><g id="link_ArgParser_entry_cli_stage"><path d="M1244.94,274.57 C1230.4,299.64 1205.42,342.7 1194.44,361.62 " fill="none" id="ArgParser-to-entry_cli_stage" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1191.74,366.28,1199.705,360.487,1194.2407,361.9503,1192.7774,356.4859,1191.74,366.28" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="63" x="1219" y="332.0669">passed to</text></g><!--MD5=[bb4ac8230b1fe25846cffcfa28898d02]
link AddCLIArgsHook to ParseCLIArgsHook--><g id="link_AddCLIArgsHook_ParseCLIArgsHook"><path d="M1393.51,466.38 C1395.51,500.88 1399.06,561.84 1401.21,598.68 " fill="none" id="AddCLIArgsHook-to-ParseCLIArgsHook" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1401.51,603.93,1404.99,594.7165,1401.2248,598.9381,1397.0031,595.1729,1401.51,603.93" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[1197768e89a16391ea4e911321bc4510]
link ParseCLIArgsHook to CLIEnd--><g id="link_ParseCLIArgsHook_CLIEnd"><path d="M1506.55,630.5 C1560.99,630.5 1622.06,630.5 1649.81,630.5 " fill="none" id="ParseCLIArgsHook-to-CLIEnd" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1654.9,630.5,1645.9,626.5,1649.9,630.5,1645.9,634.5,1654.9,630.5" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="90" x="1535.75" y="608.5669">if incorrect CLI</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="112" x="1524.75" y="623.6997">args are provided</text></g><!--MD5=[a96d77a7bc5e3b65a3b1821a6022fc53]
reverse link BoardfarmConfigure to exit_cli_stage--><g id="link_BoardfarmConfigure_exit_cli_stage"><path d="M833.2,530.5 C843.1,530.5 853.01,530.5 862.92,530.5 " fill="none" id="BoardfarmConfigure-backto-exit_cli_stage" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="828.02,530.5,837.02,534.5,833.02,530.5,837.02,526.5,828.02,530.5" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[e090cae977825acb00bc02247fd7e468]
link BoardfarmConfigure to entry_reservation_stage--><g id="link_BoardfarmConfigure_entry_reservation_stage"><path d="M697,565.38 C697,604.97 697,668.17 697,692.75 " fill="none" id="BoardfarmConfigure-to-entry_reservation_stage" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="697,697.89,701,688.89,697,692.89,693,688.89,697,697.89" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[9dc6aaa55555aa3dd9c7254c1b663ed5]
link ReserveDeviceHook to reservechoice--><g id="link_ReserveDeviceHook_reservechoice"><path d="M562.15,798.25 C554.21,821.37 542.86,854.39 536.6,872.62 " fill="none" id="ReserveDeviceHook-to-reservechoice" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="534.83,877.77,541.5232,870.545,536.4454,873.0381,533.9522,867.9603,534.83,877.77" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[c4aed8a80662f0d372d989bed52a6deb]
link reservechoice to LockableResource--><g id="link_reservechoice_LockableResource"><path d="M529.07,896.35 C526.36,904.54 522.52,917.46 521,929 C518.89,945.02 521.14,962.81 524.24,977.5 " fill="none" id="reservechoice-to-LockableResource" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="525.42,982.76,527.3455,973.1012,524.3218,977.8821,519.5409,974.8584,525.42,982.76" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="171" x="522" y="945.5669">lockable-resource != None</text></g><!--MD5=[97ef467ea16fe7bdaed76c43812ce719]
link reservechoice to CLIArgs--><g id="link_reservechoice_CLIArgs"><path d="M543.5,887.69 C572.67,887.49 650.62,890.81 698,929 C713.19,941.24 722.9,960.88 728.83,977.57 " fill="none" id="reservechoice-to-CLIArgs" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="730.56,982.64,731.4733,972.8336,728.9617,977.9023,723.893,975.3908,730.56,982.64" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="177" x="718" y="945.5669">lockable-resource == None</text></g><!--MD5=[862eeff7a6cabd33b86a4502d1d61214]
reverse link ReserveEnd to reservechoice--><g id="link_ReserveEnd_reservechoice"><path d="M419.4,786.46 C416.21,802.22 413.74,827.89 426,845 C448.63,876.6 499.2,883.85 521.31,885.51 " fill="none" id="ReserveEnd-backto-reservechoice" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="420.49,781.52,414.655,789.4543,419.419,786.4039,422.4693,791.1679,420.49,781.52" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="110" x="427" y="841.0669">if both are empty</text></g><!--MD5=[c516de58e8666e5b9ff008fd735852d0]
link exit_reservation_stage to deploy_choice--><g id="link_exit_reservation_stage_deploy_choice"><path d="M939.93,842.44 C945.88,857.69 964.07,904.3 972.98,927.13 " fill="none" id="exit_reservation_stage-to-deploy_choice" style="stroke:#008000;stroke-width:1.0;"/><polygon fill="#008000" points="974.83,931.88,975.2902,922.0419,973.015,927.2211,967.8359,924.9459,974.83,931.88" style="stroke:#008000;stroke-width:1.0;"/></g><!--MD5=[11afb9c2fbaaf22bf290b7a86e735c6f]
link deploy_choice to ParseInventory--><g id="link_deploy_choice_ParseInventory"><path d="M978,953.11 C978,1008.56 978,1256.51 978,1352.95 " fill="none" id="deploy_choice-to-ParseInventory" style="stroke:#008000;stroke-width:1.0;"/><polygon fill="#008000" points="978,1357.98,982,1348.98,978,1352.98,974,1348.98,978,1357.98" style="stroke:#008000;stroke-width:1.0;"/><text fill="#008000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="187" x="979" y="1162.5669">if deployment_type == static</text></g><!--MD5=[423c633fcfad2dd8bbd02e02c4b361e6]
link deploy_choice to entry_deploy_stage--><g id="link_deploy_choice_entry_deploy_stage"><path d="M985.02,946.36 C1016.37,965.82 1143.61,1044.82 1179.52,1067.11 " fill="none" id="deploy_choice-to-entry_deploy_stage" style="stroke:#008000;stroke-width:1.0;"/><polygon fill="#008000" points="1184.13,1069.98,1178.5934,1061.8347,1179.882,1067.3428,1174.3739,1068.6315,1184.13,1069.98" style="stroke:#008000;stroke-width:1.0;"/><text fill="#008000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="266" x="1154" y="1014.0669">if deployment_type in [dynamic, discover]</text></g><!--MD5=[e1b5fa46f9e1a7ba64efc2fa38306e00]
link DeployEnvHook to ParsePartialInv--><g id="link_DeployEnvHook_ParsePartialInv"><path d="M1461.22,1158 C1481.86,1158 1502.38,1158 1520.41,1158 " fill="none" id="DeployEnvHook-to-ParsePartialInv" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1525.43,1158,1516.43,1154,1520.43,1158,1516.43,1162,1525.43,1158" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="28" x="1479.25" y="1151.0669">calls</text></g><!--MD5=[d0c966c767fcb77b8eba1a24e9209569]
link ParsePartialInv to deploy_choice_1--><g id="link_ParsePartialInv_deploy_choice_1"><path d="M1580,1178.24 C1580,1206.03 1580,1256.91 1580,1283.05 " fill="none" id="ParsePartialInv-to-deploy_choice_1" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1580,1288.23,1584,1279.23,1580,1283.23,1576,1279.23,1580,1288.23" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[0e7a0680ed34d4718cde169eb83ace28]
link deploy_choice_1 to DeployEnvDevices--><g id="link_deploy_choice_1_DeployEnvDevices"><path d="M1569.42,1302.32 C1543.47,1304.97 1476.77,1315.79 1449,1358 C1430.8,1385.68 1437.34,1423.86 1446.64,1452.12 " fill="none" id="deploy_choice_1-to-DeployEnvDevices" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1448.28,1456.93,1449.1578,1447.1203,1446.6646,1452.1981,1441.5868,1449.705,1448.28,1456.93" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="206" x="1450" y="1397.0669">if deployment_type == dynamic</text></g><!--MD5=[44e988eb71e0721d2e4515685aeaba27]
link deploy_choice_1 to GenerateDeployedInv--><g id="link_deploy_choice_1_GenerateDeployedInv"><path d="M1585.46,1307.17 C1591.07,1312.81 1600.19,1321.55 1609,1328 C1630.53,1343.76 1647.66,1334.9 1661,1358 C1676.34,1384.56 1667.54,1397.04 1661,1427 C1647.13,1490.55 1612.16,1557.87 1588.48,1598.55 " fill="none" id="deploy_choice_1-to-GenerateDeployedInv" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1585.94,1602.89,1593.9418,1597.1479,1588.4682,1598.5763,1587.0399,1593.1027,1585.94,1602.89" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="205" x="1654" y="1496.0669">if deployment_type == discover</text></g><!--MD5=[c01b27d929f1765674bb3685369aecbb]
link DeployEnvDevices to GenerateDeployedInv--><g id="link_DeployEnvDevices_GenerateDeployedInv"><path d="M1486.91,1526.26 C1502.32,1548.02 1522.38,1576.33 1538.31,1598.82 " fill="none" id="DeployEnvDevices-to-GenerateDeployedInv" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1541.24,1602.95,1539.2991,1593.2943,1538.3487,1598.8707,1532.7723,1597.9203,1541.24,1602.95" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[d36a27d54e814de000cb128655081cf4]
link exit_deploy_stage to ParseInventory--><g id="link_exit_deploy_stage_ParseInventory"><path d="M1184.59,1241.21 C1164.87,1255.56 1083.27,1314.92 1028.72,1354.6 " fill="none" id="exit_deploy_stage-to-ParseInventory" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1024.51,1357.67,1034.1404,1355.6074,1028.5524,1354.7274,1029.4324,1349.1394,1024.51,1357.67" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[f125238d130996b84cdc6e4b86c8d645]
reverse link ParseEnd to ParseInventory--><g id="link_ParseEnd_ParseInventory"><path d="M623.51,1392.5 C665.87,1392.5 786.31,1392.5 875.1,1392.5 " fill="none" id="ParseEnd-backto-ParseInventory" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="618.28,1392.5,627.28,1396.5,623.28,1392.5,627.28,1388.5,618.28,1392.5" style="stroke:#181818;stroke-width:1.0;"/><text fill="#008000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="221" x="636.25" y="1370.5669">if deployment_type was static, and</text><text fill="#008000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="156" x="668.75" y="1385.6997">inventory_file was partial</text></g><!--MD5=[c03680c1c9d9af09389f4458a7cf5a5a]
link ParseInventory to entry_env_stage--><g id="link_ParseInventory_entry_env_stage"><path d="M946.62,1427.3 C939.37,1436.43 932.25,1446.66 927,1457 C910.74,1489.03 903.11,1531.56 900.32,1550.79 " fill="none" id="ParseInventory-to-entry_env_stage" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="899.61,1555.97,904.8088,1547.605,900.2971,1551.0174,896.8847,1546.5057,899.61,1555.97" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="266" x="928" y="1496.0669">passes FinalInv.JSON for to booting stage.</text></g><!--MD5=[f66fb7d3f34f0f3ba3c0a7e58e587da1]
link RegisterHook to AddDeviceHook--><g id="link_RegisterHook_AddDeviceHook"><path d="M678.58,1637.5 C688.48,1637.5 698.38,1637.5 708.28,1637.5 " fill="none" id="RegisterHook-to-AddDeviceHook" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="713.46,1637.5,704.46,1633.5,708.46,1637.5,704.46,1641.5,713.46,1637.5" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[71b174ebfbe5d3cd2f1df79142d9050f]
link RegisterHook to ValidateDeviceHook--><g id="link_RegisterHook_ValidateDeviceHook"><path d="M530.55,1672.15 C529.68,1692.15 528.59,1717.6 527.68,1738.48 " fill="none" id="RegisterHook-to-ValidateDeviceHook" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="527.46,1743.68,531.8428,1734.8601,527.6747,1738.6846,523.8502,1734.5165,527.46,1743.68" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[bd47103fe5d7271ab528c05c7796f506]
link ValidateDeviceHook to SetupEnvHook--><g id="link_ValidateDeviceHook_SetupEnvHook"><path d="M518.97,1813.26 C514.49,1834.75 508.68,1862.63 504.03,1884.98 " fill="none" id="ValidateDeviceHook-to-SetupEnvHook" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="502.99,1889.95,508.7359,1881.951,504.0063,1885.0544,500.9029,1880.3248,502.99,1889.95" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="155" x="512" y="1856.0669">passes device_manager</text></g><!--MD5=[dafb354bddb89787a78094aff01fbbee]
link SetupEnvHook to skip_choice--><g id="link_SetupEnvHook_skip_choice"><path d="M472.52,1959.12 C451.65,1988.99 422.39,2030.89 408.67,2050.52 " fill="none" id="SetupEnvHook-to-skip_choice" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="405.53,2055.02,413.9574,2049.923,408.3887,2050.9178,407.3939,2045.3491,405.53,2055.02" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[9833e748707cd3abac853c874b97c22e]
link skip_choice to Booting--><g id="link_skip_choice_Booting"><path d="M399.75,2073.36 C397.54,2090.73 392.62,2129.46 386.61,2176.79 " fill="none" id="skip_choice-to-Booting" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="385.95,2181.99,391.0473,2173.5628,386.5772,2177.0295,383.1105,2172.5593,385.95,2181.99" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135" x="392" y="2148.0669">if skip_boot == False</text></g><!--MD5=[9780217c3ef4b6305d0565734ff68204]
link skip_choice to SkipBootHook--><g id="link_skip_choice_SkipBootHook"><path d="M413.25,2062.5 C439.69,2062.5 505.31,2062.5 573.99,2062.5 " fill="none" id="skip_choice-to-SkipBootHook" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="579.36,2062.5,570.36,2058.5,574.36,2062.5,570.36,2066.5,579.36,2062.5" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130" x="431.25" y="2055.5669">if skip_boot == True</text></g><!--MD5=[c8d9848ba2cf47ad78e62336975a1f57]
link Booting to PostEnvSetupHook--><g id="link_Booting_PostEnvSetupHook"><path d="M605.88,2797.46 C611.58,2802.74 617.29,2807.93 623,2813 C660.78,2846.55 707.83,2878.79 744.63,2902.18 " fill="none" id="Booting-to-PostEnvSetupHook" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="749.07,2904.99,743.6101,2896.7931,744.847,2902.313,739.327,2903.5499,749.07,2904.99" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[572eb7a6e0fa6ffef447c449e47ea0b5]
link exit_env_stage to choice_output--><g id="link_exit_env_stage_choice_output"><path d="M1028.62,1713.72 C1038.09,1731.24 1070,1794.42 1070,1850.5 C1070,1850.5 1070,1850.5 1070,2063.5 C1070,2226.84 1084.38,2424.46 1088.75,2480.82 " fill="none" id="exit_env_stage-to-choice_output" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1089.17,2486.12,1092.4639,2476.8383,1088.7843,2481.1349,1084.4877,2477.4553,1089.17,2486.12" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="142" x="1071" y="1929.0669">returns booting status</text></g><!--MD5=[aaf23d166cc8c79552af3ff33613f414]
link choice_output to *end--><g id="link_choice_output_*end"><path d="M1094.25,2505.88 C1115,2542.05 1207.32,2704.49 1272,2843 C1285.44,2871.78 1298.97,2906.51 1306.02,2925.14 " fill="none" id="choice_output-to-*end" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1307.83,2929.95,1308.389,2920.117,1306.0619,2925.2731,1300.9058,2922.946,1307.83,2929.95" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="97" x="1286" y="2863.5669">if booting failed</text></g><!--MD5=[4f3da24a863a9554577a79ca3182d9e3]
link choice_output to Execution--><g id="link_choice_output_Execution"><path d="M1088.59,2508.3 C1082.6,2552.71 1062.07,2738.87 1117,2875 C1121.98,2887.34 1130.3,2899.07 1138.9,2909.02 " fill="none" id="choice_output-to-Execution" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1142.32,2912.88,1139.3304,2903.4959,1138.9982,2909.143,1133.3511,2908.8108,1142.32,2912.88" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="149" x="1118" y="2856.0669">if booting succeeded or</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="61" x="1164" y="2871.1997">skip_boot</text></g><!--MD5=[677d022932f217905b1e003bf4065d7f]
link Execution to entry_release_stage--><g id="link_Execution_entry_release_stage"><path d="M1095.7,2966.05 C1004.31,2997.47 856.27,3048.37 815.62,3062.35 " fill="none" id="Execution-to-entry_release_stage" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="810.42,3064.14,820.232,3064.9912,815.1475,3062.5118,817.6269,3057.4273,810.42,3064.14" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="91" x="977" y="3017.0669">on completion</text></g><!--MD5=[319f3d6d52e1068f6aa19724090302da]
link Booting to entry_release_stage--><g id="link_Booting_entry_release_stage"><path d="M274.18,2813.15 C276.02,2877.65 292.08,2940.77 334,2990 C395.9,3062.69 728.29,3066.09 793.79,3066.05 " fill="none" id="Booting-to-entry_release_stage" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="798.98,3066.04,789.9686,3062.0657,793.98,3066.0543,789.9915,3070.0657,798.98,3066.04" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="38" x="335" y="2944.0669">on fail</text></g><!--MD5=[e56e11ab392a6da4ba1d32276feda79e]
link PostEnvSetupHook to entry_release_stage--><g id="link_PostEnvSetupHook_entry_release_stage"><path d="M805,2974.13 C805,3001.27 805,3037.74 805,3055.46 " fill="none" id="PostEnvSetupHook-to-entry_release_stage" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="805,3060.71,809,3051.71,805,3055.71,801,3051.71,805,3060.71" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="38" x="806" y="3017.0669">on fail</text></g><!--MD5=[0d9a656e063ace387dcc1a4b56e69fa0]
link ReleaseDeviceHook to DeviceShutdownHook--><g id="link_ReleaseDeviceHook_DeviceShutdownHook"><path d="M819.43,3187.3 C814.89,3201.59 811.61,3218.49 814,3234 C815.25,3242.14 817.35,3250.66 819.74,3258.73 " fill="none" id="ReleaseDeviceHook-to-DeviceShutdownHook" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="821.25,3263.68,822.4469,3253.9041,819.7896,3258.898,814.7958,3256.2407,821.25,3263.68" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="28" x="815" y="3230.0669">calls</text></g><!--MD5=[e54974110a792b071438257c7bab0360]
reverse link *end to exit_release_stage--><g id="link_*end_exit_release_stage"><path d="M1310.39,2954.83 C1308.18,3007.13 1300.61,3186.47 1299.22,3219.31 " fill="none" id="*end-backto-exit_release_stage" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1310.61,2949.63,1306.2283,2958.4505,1310.3959,2954.6254,1314.221,2958.793,1310.61,2949.63" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="66" x="1307" y="3064.0669">successful</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="23" x="1328.5" y="3079.1997">exit</text></g><!--MD5=[e885c611a601abb6573cfa30504419fa]
@startuml Boardfarm Current Flow
hide empty description


[*] - -> Main : start boardfarm
Main - -> PluginManager : init
Main - -> ArgParser : init

state CLIEnd <<end>>
state "CLI Parsing Stage" as CLI {
    state "entry" as entry_cli_stage <<entrypoint>>
    state "exit" as exit_cli_stage <<exitpoint>>

    state ParseCLIArgsHook ##[bold]green
    note left of ParseCLIArgsHook
        Replace arg **bfconfig_file** with **inventory_file**
        Add arg **deployment_type**

        **deployment_type** can be **static**/**dynamic**/**discover**
    end note

    PluginManager - -> entry_cli_stage
    ArgParser - -> entry_cli_stage : passed to
    AddCLIArgsHook - -> ParseCLIArgsHook

}
ParseCLIArgsHook -right-> CLIEnd : if incorrect CLI\nargs are provided
exit_cli_stage -left-> BoardfarmConfigure


state ReserveEnd <<end>>
state "Reserve Device Stage" as Reservation{
    state reservechoice <<choice>>
    state "entry" as entry_reservation_stage <<entrypoint>>
    state "exit" as exit_reservation_stage <<exitpoint>>

    BoardfarmConfigure -down-> entry_reservation_stage

    ReserveDeviceHook - -> reservechoice
    reservechoice - -> LockableResource : lockable-resource != None
    reservechoice - -> CLIArgs : lockable-resource == None
}
reservechoice -up-> ReserveEnd : if both are empty


state deploy_choice <<choice>>
exit_reservation_stage -[#green]-> deploy_choice
deploy_choice -[#green]-> ParseInventory : <color:green>if deployment_type == static</color>

state "Env Deployment Stage" as DeployEnv ##[bold]green {
    state "entry" as entry_deploy_stage <<entrypoint>>
    state "exit" as exit_deploy_stage <<exitpoint>>
    state deploy_choice_1 <<choice>>

    deploy_choice -[#green]-> entry_deploy_stage : <color:green>if deployment_type in [dynamic, discover]</color>
    DeployEnvHook -right-> ParsePartialInv : calls
    note right of ParsePartialInv
        Parsing partial INV.json will not be a
        separate hook spec of core.
        The plugin for docker factory shall handle
        the parsing internally by implementing the
        boardfarm_deploy_env_hook
    end note

    note right of deploy_choice_1
        if deployment_type is discover it means
        that we want to regenerate the final INV.JSON
        based on the partial INV JSON provided earlier.
    end note

    ParsePartialInv - -> deploy_choice_1
    deploy_choice_1 - -> DeployEnvDevices : if deployment_type == dynamic
    deploy_choice_1 - -> GenerateDeployedInv: if deployment_type == discover
    DeployEnvDevices - -> GenerateDeployedInv


}

state ParseEnd <<end>>
exit_deploy_stage - -> ParseInventory
ParseInventory -left-> ParseEnd : <color:green>if deployment_type was static, and</color>\n<color:green>inventory_file was partial</color>



state "Env Setup Stage" as EnvSetup{
    state "entry" as entry_env_stage <<entrypoint>>
    state "exit" as exit_env_stage <<exitpoint>>

    ParseInventory - -> entry_env_stage: passes FinalInv.JSON for to booting stage.



    state RegisterHook ##[bold]green
    state AddDeviceHook ##[bold]green
    state ValidateDeviceHook ##[bold]green
    state SetupEnvHook ##[bold]green

    note left of RegisterHook
        Moved this up.
        Since registering devices is a core activity.
        And should happen first before intiating booting.
    end note

    note left of SetupEnvHook
            Renamed it to SetupEnvHook
            It does not deploy but calls all booting hooks.
    end note

    RegisterHook -right-> AddDeviceHook
    RegisterHook - -> ValidateDeviceHook
    ValidateDeviceHook - -> SetupEnvHook : passes device_manager

    state skip_choice <<choice>>

    SetupEnvHook - -> skip_choice
    skip_choice - -> Booting : if skip_boot == False
    skip_choice -right-> SkipBootHook : if skip_boot == True

    state SkipBootHook ##[bold]green

    State "Booting stage" as Booting ##[bold]green {

        ServerBootHook -right[#green]-> SetupServer : internal call
        ServerBootHook -[#green]-> ServerConfigureHook
        ServerConfigureHook -[#green]-> DeviceBootHook

        DeviceBootHook -right[#green]-> BootCPE : internal call
        DeviceBootHook -[#green]-> DeviceConfigureHook
        DeviceConfigureHook -[#green]-> AddnDeviceBootHook

        AddnDeviceBootHook -right[#green]-> BootAddnDevice : internal call
        AddnDeviceBootHook -[#green]-> AddnDeviceConfigureHook

    }

    note right of Booting
            The Booting stage must be a simple call to all booting
            hook implementations implemented by devices.
    end note

    note left of PostEnvSetupHook
            Renamed now to PostEnvSetupHook
    end note

    Booting - -> PostEnvSetupHook
}


state choice_output <<choice>>

exit_env_stage - -> choice_output : returns booting status

choice_output - -> [*] : if booting failed
choice_output - -> Execution : if booting succeeded or\n skip_boot

state "Release Env Stage" as ReleaseEnv {
    state "entry" as entry_release_stage <<entrypoint>>
    state "exit" as exit_release_stage <<exitpoint>>

    Execution - -> entry_release_stage : on completion
    Booting - -> entry_release_stage : on fail
    PostEnvSetupHook - -> entry_release_stage : on fail
    ReleaseDeviceHook - -> DeviceShutdownHook : calls
    note right of DeviceShutdownHook
            If we have a device shutdown hook.
            Shouldn't we have a device powerup hook?
    end note
}

exit_release_stage -left-> [*] : successful\nexit


PluginManager: init all BF plugins\nReads BF entry-points
AddCLIArgsHook : boardfarm_add_cmdline_args()
ParseCLIArgsHook : boardfarm_cmdline_parse()
ReserveDeviceHook : boardfarm_reserve_devices()
LockableResource : return board ID
BoardfarmConfigure: boardfarm_configure()\nTBD, adds hook stages to the core
CLIArgs : pick board-name from CLI
ParseInventory : parse_boardfarm_config()\nParses INV.json for devices
SetupEnvHook : boardfarm_setup_env()\nCalling all device booting hooks
PostEnvSetupHook : boardfarm_post_deploy_devices()\nDisconnect disposable services
RegisterHook : boardfarm_register_devices()\nShould be a Core hook not device hook
AddDeviceHook : boardfarm_add_devices()\nShould be a core hook not device hook
ValidateDeviceHook : validate_device_requirements()\nValidate against INV.json
ServerBootHook : boardfarm_server_boot()\bBBoot servers
ServerConfigureHook : boardfarm_server_configure()\nConfigure servers
DeviceBootHook : boardfarm_device_boot()\nBoot CPE
DeviceConfigureHook : boardfarm_device_configure()\nConfigure CPE
AddnDeviceBootHook : boardfarm_attached_device_boot()\nBoot Extras
AddnDeviceConfigureHook : boardfarm_attached_device_configure()\nConfigure Extras
ReleaseDeviceHook: boardfarm_release_devices()\nRelease all devices
DeviceShutdownHook: boardfarm_shutdown_device()\nShutdown connections
DeployEnvHook : boardfarm_deploy_env()\nParses the INV and ENV to deploy\ncontainers
DeployEnvDevices : boardfarm_deploy_env_devices()\nInteracts with docker factory
GenerateDeployedInv : boardfarm_generate_inventory()\nshould provide the final INV.json
SkipBootHook : boardfarm_skip_boot()\nIn case there are activities\nneeded to be performed before handling out the device
Execution : Can be tests or interact session.
@enduml

PlantUML version 1.2022.7(Mon Aug 22 19:01:30 CEST 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: null
--></g></svg>
